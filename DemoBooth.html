<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ç›¸æœºæ‹ç…§+è¾¹æ¡†åˆæˆ</title>
  <style>
    body { text-align: center; font-family: sans-serif; background-color: #f0f2f5; }
    #video, #canvas { width: 100%; max-width: 400px; border-radius: 10px; margin-top: 20px; }
    #capture, #retry, #download { margin: 10px; padding: 10px 20px; font-size: 16px; }
    #retry, #download { display: none; }
  </style>
</head>
<body>

<h2>ğŸ“¸ æ‹å¼ ç…§ï¼åŠ ä¸Šä½ çš„ä¸“å±è¾¹æ¡† âœ¨</h2>

<video id="video" autoplay playsinline></video><br>
<button id="capture">æ‹ç…§</button>
<button id="retry">é‡æ–°æ‹æ‘„</button><br>
<canvas id="canvas" style="display:none;"></canvas><br>
<a id="download" download="my-photo.png" style="display:none;">ğŸ“¥ ä¸‹è½½ç…§ç‰‡</a>

<script>
  const video = document.getElementById('video');
  const canvas = document.getElementById('canvas');
  const captureButton = document.getElementById('capture');
  const retryButton = document.getElementById('retry');
  const downloadLink = document.getElementById('download');
  let stream;

  async function startCamera() {
    try {
      stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: 'user' } });
      video.srcObject = stream;
    } catch (error) {
      alert('æ— æ³•è®¿é—®ç›¸æœºï¼Œè¯·æ£€æŸ¥æƒé™è®¾ç½®ï¼');
      console.error(error);
    }
  }

  captureButton.addEventListener('click', () => {
    const context = canvas.getContext('2d');
    canvas.width = video.videoWidth;
    canvas.height = video.videoHeight;

    // æ‹ä¸‹è§†é¢‘æµ
    context.drawImage(video, 0, 0, canvas.width, canvas.height);

    // åŠ è½½å¹¶å åŠ è¾¹æ¡†Frame
    const frame = new Image();
    frame.src = 'your-frame.png'; // è¿™é‡Œæ¢æˆä½ çš„è¾¹æ¡†å›¾ç‰‡
    frame.onload = () => {
      context.drawImage(frame, 0, 0, canvas.width, canvas.height);

      // åœæ­¢æ‘„åƒå¤´
      stream.getTracks().forEach(track => track.stop());

      // éšè—è§†é¢‘ï¼Œæ˜¾ç¤ºcanvas
      video.style.display = 'none';
      canvas.style.display = 'block';
      captureButton.style.display = 'none';
      retryButton.style.display = 'inline-block';
      downloadLink.href = canvas.toDataURL('image/png');
      downloadLink.style.display = 'inline-block';
    };
  });

  retryButton.addEventListener('click', () => {
    location.reload(); // é‡æ–°åŠ è½½é¡µé¢é‡æ–°æ‹ç…§
  });

  startCamera();
</script>

</body>
</html>
